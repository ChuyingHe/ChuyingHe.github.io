
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../ckad-7/">
      
      
        <link rel="next" href="../ckad-9/">
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.5">
    
    
      
        <title>8.2021更新的考试内容 - Chuying's notebook</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.7a7fce14.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Chuying&#39;s notebook" class="md-header__button md-logo" aria-label="Chuying's notebook" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Chuying's notebook
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              8.2021更新的考试内容
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Chuying&#39;s notebook" class="md-nav__button md-logo" aria-label="Chuying's notebook" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Chuying's notebook
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Administrator
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Administrator
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
      
      
      
        <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
          Hardware
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Hardware
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../administrator/hardware/disk/" class="md-nav__link">
        Disk
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../administrator/linux/" class="md-nav__link">
        Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../administrator/infrastructure/" class="md-nav__link">
        Infrastructure
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Architect
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Architect
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/architectural_thinking/" class="md-nav__link">
        Architectural Thinking
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
      
      
      
        <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
          AWS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          AWS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/aws/cp/" class="md-nav__link">
        Cloud Practitioner
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2" >
      
      
      
        <label class="md-nav__link" for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
          Solution Architect Associate
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2_2">
          <span class="md-nav__icon md-icon"></span>
          Solution Architect Associate
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/aws/saa/" class="md-nav__link">
        Intro
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/aws/saa/4.security/" class="md-nav__link">
        4. Security
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/aws/sap/" class="md-nav__link">
        Solution Architect Professional
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
          IBM
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          IBM
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/ibm/security/" class="md-nav__link">
        Security
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/ibm/storage/" class="md-nav__link">
        Storage
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
      
      
      
        <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
          Guide from MemiLavi
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          Guide from MemiLavi
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/memi/memi-1/" class="md-nav__link">
        1. Welcome
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/memi/memi-2/" class="md-nav__link">
        2. What is a Software Architect
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/memi/memi-3/" class="md-nav__link">
        3. The Architect's Mindset
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/memi/memi-4/" class="md-nav__link">
        4. The Architecture Process
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/memi/memi-5/" class="md-nav__link">
        5. Working with System Requirements
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/memi/memi-6/" class="md-nav__link">
        6. Types of Applications
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/memi/memi-7/" class="md-nav__link">
        7. Selecting Technology Stack
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/memi/memi-8/" class="md-nav__link">
        8. Meet the *-ilities
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/memi/memi-9/" class="md-nav__link">
        9. Components' Architecture
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/memi/memi-10/" class="md-nav__link">
        10. Design Patterns
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/memi/memi-11/" class="md-nav__link">
        11. System Architecture
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/memi/memi-12/" class="md-nav__link">
        12. Additional Considerations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/memi/memi-13/" class="md-nav__link">
        13. Architecture Document
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/memi/memi-14/" class="md-nav__link">
        14. Case Study
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/memi/memi-15/" class="md-nav__link">
        15. Advanced Architecture Topics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/memi/memi-16/" class="md-nav__link">
        16. Soft Skills
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
      
      
      
        <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
          Design Patterns (DP)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_5">
          <span class="md-nav__icon md-icon"></span>
          Design Patterns (DP)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/design_patterns/1_intro/" class="md-nav__link">
        1. Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/design_patterns/2_creational/" class="md-nav__link">
        2. Creational DP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/design_patterns/3_structural/" class="md-nav__link">
        3. Structural DP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/design_patterns/4_behavioral/" class="md-nav__link">
        4. Behavioral DP
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
      
      
      
        <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
          GCP PCAC
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_6">
          <span class="md-nav__icon md-icon"></span>
          GCP PCAC
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architect/gcp/1.preparation/" class="md-nav__link">
        1. Preparation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Automation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Automation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../automation/ansible/" class="md-nav__link">
        Ansible
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../automation/argocd/" class="md-nav__link">
        ArgoCD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../automation/benthos/" class="md-nav__link">
        Benthos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../automation/helm/" class="md-nav__link">
        Helm
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
      
      
      
        <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
          Instana
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_5">
          <span class="md-nav__icon md-icon"></span>
          Instana
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../automation/instana/installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../automation/instana/clis/" class="md-nav__link">
        CLIs, Namespaces
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../automation/instana/theory/1.jargons/" class="md-nav__link">
        Jargons
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../automation/instana/theory/2.agent_sensor/" class="md-nav__link">
        Agent, Sensor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../automation/instana/theory/3.trace/" class="md-nav__link">
        Trace, Call, Span
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../automation/instana/theory/4.event/" class="md-nav__link">
        Event, Alert
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../automation/instana/theory/5.api/" class="md-nav__link">
        Integration, SKD, API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../automation/instana/theory/6.ui/" class="md-nav__link">
        UI
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../automation/n8n/" class="md-nav__link">
        n8n
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../automation/nodered/intro/" class="md-nav__link">
        NodeRed
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../automation/icalBuddy/" class="md-nav__link">
        iCalBuddy
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Bash Script
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Bash Script
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../bash_script/" class="md-nav__link">
        Basics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../bash_script/exercises/" class="md-nav__link">
        Exercises
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Cloud
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Cloud
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../yaml/" class="md-nav__link">
        YAML
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../docker/" class="md-nav__link">
        Docker
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
          Kubernetes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_6_3">
          <span class="md-nav__icon md-icon"></span>
          Kubernetes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3_1" >
      
      
      
        <label class="md-nav__link" for="__nav_6_3_1" id="__nav_6_3_1_label" tabindex="0">
          CKA
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_3_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_3_1">
          <span class="md-nav__icon md-icon"></span>
          CKA
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cka/cka-0/" class="md-nav__link">
        Read before exam
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cka/cka-1/" class="md-nav__link">
        cka-1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cka/cka-3/" class="md-nav__link">
        cka-3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cka/cka-4/" class="md-nav__link">
        cka-4
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cka/cka-5/" class="md-nav__link">
        cka-5
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cka/cka-6/" class="md-nav__link">
        cka-6
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cka/cka-7/" class="md-nav__link">
        cka-7
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cka/cka-8/" class="md-nav__link">
        8.Storage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cka/cka-9/" class="md-nav__link">
        cka-9
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cka/cka-10/" class="md-nav__link">
        cka-10
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cka/cka-11/" class="md-nav__link">
        cka-11
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cka/cka-12/" class="md-nav__link">
        cka-12
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cka/cka-13/" class="md-nav__link">
        cka-13
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cka/cka-14/" class="md-nav__link">
        cka-14
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cka/cka-15/" class="md-nav__link">
        cka-15
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cka/cka-16/" class="md-nav__link">
        cka-16
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_6_3_2" id="__nav_6_3_2_label" tabindex="0">
          CKAD
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_3_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_6_3_2">
          <span class="md-nav__icon md-icon"></span>
          CKAD
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ckad-0/" class="md-nav__link">
        Read before exam
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ckad-1/" class="md-nav__link">
        1.核心概念介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ckad-2/" class="md-nav__link">
        2.配置
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ckad-3/" class="md-nav__link">
        3.多容器Pod
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ckad-4/" class="md-nav__link">
        4.容器状态监测
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ckad-5/" class="md-nav__link">
        5.Pod设计
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ckad-6/" class="md-nav__link">
        6.服务与网络
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ckad-7/" class="md-nav__link">
        7.容器数据的可持久化
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          8.2021更新的考试内容
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        8.2021更新的考试内容
      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="Table of Contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    镜像生成
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#k8s" class="md-nav__link">
    k8s 安全性
  </a>
  
    <nav class="md-nav" aria-label="k8s 安全性">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-authentication" class="md-nav__link">
    1. Authentication
  </a>
  
    <nav class="md-nav" aria-label="1. Authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#user" class="md-nav__link">
    用户帐号 / User
  </a>
  
    <nav class="md-nav" aria-label="用户帐号 / User">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    认证机制 1：用户名 + 密码
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-token" class="md-nav__link">
    认证机制 2：用户名 + Token
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-certificates" class="md-nav__link">
    认证机制 3：证书 / Certificates
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-authorization" class="md-nav__link">
    2. Authorization：访问者可以做什么？
  </a>
  
    <nav class="md-nav" aria-label="2. Authorization：访问者可以做什么？">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1node-authorizor" class="md-nav__link">
    授权机制 1：Node Authorizor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2abac" class="md-nav__link">
    授权机制 2：ABAC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3rbac" class="md-nav__link">
    授权机制 3：RBAC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4webhook" class="md-nav__link">
    授权机制 4：Webhook
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3. 集群内部的交流
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-admission-controller" class="md-nav__link">
    4. Admission Controller
  </a>
  
    <nav class="md-nav" aria-label="4. Admission Controller">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#k8sac" class="md-nav__link">
    k8s提供的AC类型
  </a>
  
    <nav class="md-nav" aria-label="k8s提供的AC类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-validating-ac" class="md-nav__link">
    1. Validating AC（验证类）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-mutating-ac" class="md-nav__link">
    2. Mutating AC（修改类）
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#admission-controller" class="md-nav__link">
    自定义Admission Controller
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#namespaces" class="md-nav__link">
    Namespaces
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-groups" class="md-nav__link">
    API Groups
  </a>
  
    <nav class="md-nav" aria-label="API Groups">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    API的使用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api_1" class="md-nav__link">
    API组的版本
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api_2" class="md-nav__link">
    启用/禁用API版本
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api_3" class="md-nav__link">
    API更新准则
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api_4" class="md-nav__link">
    API弃用准则
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api_5" class="md-nav__link">
    API版本发展
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    自定义资源
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-strategies" class="md-nav__link">
    Deployment Strategies
  </a>
  
    <nav class="md-nav" aria-label="Deployment Strategies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bluegreen" class="md-nav__link">
    Blue/Green
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#canary" class="md-nav__link">
    Canary
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#helm-chart" class="md-nav__link">
    Helm Chart
  </a>
  
    <nav class="md-nav" aria-label="Helm Chart">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    常用命令：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux" class="md-nav__link">
    在Linux上安装
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    其他
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ckad-9/" class="md-nav__link">
        其他
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../others/" class="md-nav__link">
        Others
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../minikube/" class="md-nav__link">
        Minikube
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../podman/" class="md-nav__link">
        Podman
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6_6" id="__nav_6_6_label" tabindex="0">
          OpenShift
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_6">
          <span class="md-nav__icon md-icon"></span>
          OpenShift
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/deployment/" class="md-nav__link">
        App Deployment
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_6_2" >
      
      
      
        <label class="md-nav__link" for="__nav_6_6_2" id="__nav_6_6_2_label" tabindex="0">
          Installation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_6_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_6_2">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/installation/" class="md-nav__link">
        Intro
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/installation/ipi/" class="md-nav__link">
        IPI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/installation/upi/" class="md-nav__link">
        UPI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/installation/mirror_registry/" class="md-nav__link">
        Mirror Registry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/installation/network/" class="md-nav__link">
        Network
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/internal_registry/" class="md-nav__link">
        Internal Registry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/monitoring_stack/" class="md-nav__link">
        Monitoring Stack
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/operator/" class="md-nav__link">
        Operator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/pipeline/" class="md-nav__link">
        Pipeline
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_6_7" >
      
      
      
        <label class="md-nav__link" for="__nav_6_6_7" id="__nav_6_6_7_label" tabindex="0">
          DO288
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_6_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_6_7">
          <span class="md-nav__icon md-icon"></span>
          DO288
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/do288/01_deploy_app/" class="md-nav__link">
        Deploying and Managing Applications
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/do288/02/" class="md-nav__link">
        2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/do288/03/" class="md-nav__link">
        3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/do288/04/" class="md-nav__link">
        4
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/do288/05/" class="md-nav__link">
        5
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/do288/06/" class="md-nav__link">
        6
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/do288/07/" class="md-nav__link">
        7
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/do288/08/" class="md-nav__link">
        8
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_6_8" >
      
      
      
        <label class="md-nav__link" for="__nav_6_6_8" id="__nav_6_6_8_label" tabindex="0">
          DO280
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_6_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_6_8">
          <span class="md-nav__icon md-icon"></span>
          DO280
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/do280/01_manifest_kustimize/" class="md-nav__link">
        1. Manifest & Kustomize
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/do280/02_template_helm/" class="md-nav__link">
        2. OC Template & Helm Chart
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/do280/03_auth/" class="md-nav__link">
        3. Authentication and Authorization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/do280/04_network_security/" class="md-nav__link">
        4. Network Security
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/do280/05_expose_sni_app/" class="md-nav__link">
        5. Expose SNI Application
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/do280/06_developer_self_service/" class="md-nav__link">
        6. Enable Developer Self-Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/do280/07_kubernetes_operator/" class="md-nav__link">
        7. Kubernetes Operator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/do280/08_application_security/" class="md-nav__link">
        8. Application Security
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/do280/09_oc_updates/" class="md-nav__link">
        9. Openshift Updates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/do280/10/" class="md-nav__link">
        10
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_6_9" >
      
      
      
        <label class="md-nav__link" for="__nav_6_6_9" id="__nav_6_6_9_label" tabindex="0">
          DO322
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_6_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_6_9">
          <span class="md-nav__icon md-icon"></span>
          DO322
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/do322/01/" class="md-nav__link">
        1. Intro to OpenShift Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/do322/02/" class="md-nav__link">
        2. IPI on Cloud
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/do322/03/" class="md-nav__link">
        3. IPI & UPI on Virtual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/do322/04/" class="md-nav__link">
        4. UPI without Infrastructure Provider
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/do322/05/" class="md-nav__link">
        5. Operations & Maintainance
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Data Scientist
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Data Scientist
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../data_scientist/embedding/" class="md-nav__link">
        Embedding
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../data_scientist/elastic_search/" class="md-nav__link">
        ElasticSearch
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../design_thinking/" class="md-nav__link">
        Design Thinking
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
      
      
      
        <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
          DevOps
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          DevOps
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../dev_ops/observability/" class="md-nav__link">
        Observability
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
      
      
      
        <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
          Ecommerce
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Ecommerce
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ecommerce/wordpress/" class="md-nav__link">
        Wordpress
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
      
      
      
        <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
          Frontend
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          Frontend
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_1" >
      
      
      
        <label class="md-nav__link" for="__nav_11_1" id="__nav_11_1_label" tabindex="0">
          CSS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_11_1">
          <span class="md-nav__icon md-icon"></span>
          CSS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../frontend/css/css-in-depth/" class="md-nav__link">
        CSS In Depth
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../frontend/css/shapes/" class="md-nav__link">
        Shape
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../frontend/cra/" class="md-nav__link">
        CRA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../frontend/gsap/" class="md-nav__link">
        GSAP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../frontend/js/" class="md-nav__link">
        JavaScript
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../frontend/nginx/" class="md-nav__link">
        Nginx
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_6" >
      
      
      
        <label class="md-nav__link" for="__nav_11_6" id="__nav_11_6_label" tabindex="0">
          React
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_11_6">
          <span class="md-nav__icon md-icon"></span>
          React
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../frontend/react/hooks/" class="md-nav__link">
        Hooks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../frontend/react/basics/" class="md-nav__link">
        Basics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../frontend/react/bugs/" class="md-nav__link">
        Bugs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../frontend/react/oblivion/" class="md-nav__link">
        Oblivion
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../frontend/react/resources/" class="md-nav__link">
        Resources
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../frontend/web_design/" class="md-nav__link">
        Web Design
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../ffmpeg/" class="md-nav__link">
        ffmpeg
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
      
      
      
        <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
          IDEs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_13">
          <span class="md-nav__icon md-icon"></span>
          IDEs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ide/vscode/" class="md-nav__link">
        VSCode
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" >
      
      
      
        <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
          Monitoring
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_14">
          <span class="md-nav__icon md-icon"></span>
          Monitoring
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../monitoring/grafana/" class="md-nav__link">
        Grafana
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14_2" >
      
      
      
        <label class="md-nav__link" for="__nav_14_2" id="__nav_14_2_label" tabindex="0">
          Prometheus
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_14_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_14_2">
          <span class="md-nav__icon md-icon"></span>
          Prometheus
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../monitoring/prometheus/" class="md-nav__link">
        Intro
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../monitoring/prometheus/hands_on/" class="md-nav__link">
        HandsOn
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15" >
      
      
      
        <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0">
          Network
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_15">
          <span class="md-nav__icon md-icon"></span>
          Network
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../network/ip/" class="md-nav__link">
        IP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../network/loadbalancer/" class="md-nav__link">
        LoadBalancer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../network/protocols/" class="md-nav__link">
        Protocols
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_16" >
      
      
      
        <label class="md-nav__link" for="__nav_16" id="__nav_16_label" tabindex="0">
          Project Mgmt
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_16">
          <span class="md-nav__icon md-icon"></span>
          Project Mgmt
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../project_mgmt/agile/" class="md-nav__link">
        Agile
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../project_mgmt/git/" class="md-nav__link">
        Git
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../project_mgmt/ibm_internal/" class="md-nav__link">
        IBM PM
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_17" >
      
      
      
        <label class="md-nav__link" for="__nav_17" id="__nav_17_label" tabindex="0">
          Python
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_17_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_17">
          <span class="md-nav__icon md-icon"></span>
          Python
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../python/grammars/" class="md-nav__link">
        Grammars
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../python/fastapi/" class="md-nav__link">
        FastAPI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../python/oblivion/" class="md-nav__link">
        Oblivion
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../python/dependencies/" class="md-nav__link">
        Use dependencies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../python/build_dependency/" class="md-nav__link">
        Build Own Dependency
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../python/virtual_env/" class="md-nav__link">
        Virtual environment
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../regex/" class="md-nav__link">
        Regex
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_19" >
      
      
      
        <label class="md-nav__link" for="__nav_19" id="__nav_19_label" tabindex="0">
          Sketch
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_19_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_19">
          <span class="md-nav__icon md-icon"></span>
          Sketch
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../sketch/procreate/" class="md-nav__link">
        Procreate
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_20" >
      
      
      
        <label class="md-nav__link" for="__nav_20" id="__nav_20_label" tabindex="0">
          Working Notes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_20_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_20">
          <span class="md-nav__icon md-icon"></span>
          Working Notes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../working_notes/01_2025/" class="md-nav__link">
        202501
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="Table of Contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    镜像生成
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#k8s" class="md-nav__link">
    k8s 安全性
  </a>
  
    <nav class="md-nav" aria-label="k8s 安全性">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-authentication" class="md-nav__link">
    1. Authentication
  </a>
  
    <nav class="md-nav" aria-label="1. Authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#user" class="md-nav__link">
    用户帐号 / User
  </a>
  
    <nav class="md-nav" aria-label="用户帐号 / User">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    认证机制 1：用户名 + 密码
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-token" class="md-nav__link">
    认证机制 2：用户名 + Token
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-certificates" class="md-nav__link">
    认证机制 3：证书 / Certificates
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-authorization" class="md-nav__link">
    2. Authorization：访问者可以做什么？
  </a>
  
    <nav class="md-nav" aria-label="2. Authorization：访问者可以做什么？">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1node-authorizor" class="md-nav__link">
    授权机制 1：Node Authorizor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2abac" class="md-nav__link">
    授权机制 2：ABAC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3rbac" class="md-nav__link">
    授权机制 3：RBAC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4webhook" class="md-nav__link">
    授权机制 4：Webhook
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3. 集群内部的交流
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-admission-controller" class="md-nav__link">
    4. Admission Controller
  </a>
  
    <nav class="md-nav" aria-label="4. Admission Controller">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#k8sac" class="md-nav__link">
    k8s提供的AC类型
  </a>
  
    <nav class="md-nav" aria-label="k8s提供的AC类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-validating-ac" class="md-nav__link">
    1. Validating AC（验证类）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-mutating-ac" class="md-nav__link">
    2. Mutating AC（修改类）
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#admission-controller" class="md-nav__link">
    自定义Admission Controller
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#namespaces" class="md-nav__link">
    Namespaces
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-groups" class="md-nav__link">
    API Groups
  </a>
  
    <nav class="md-nav" aria-label="API Groups">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    API的使用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api_1" class="md-nav__link">
    API组的版本
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api_2" class="md-nav__link">
    启用/禁用API版本
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api_3" class="md-nav__link">
    API更新准则
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api_4" class="md-nav__link">
    API弃用准则
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api_5" class="md-nav__link">
    API版本发展
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    自定义资源
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-strategies" class="md-nav__link">
    Deployment Strategies
  </a>
  
    <nav class="md-nav" aria-label="Deployment Strategies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bluegreen" class="md-nav__link">
    Blue/Green
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#canary" class="md-nav__link">
    Canary
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#helm-chart" class="md-nav__link">
    Helm Chart
  </a>
  
    <nav class="md-nav" aria-label="Helm Chart">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    常用命令：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux" class="md-nav__link">
    在Linux上安装
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    其他
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>8.2021更新的考试内容</h1>

<h3 id="_1">镜像生成<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<p>当我们在镜像库（比如<a href="https://hub.docker.com/">Dockerhub</a>）中找不到所需的镜像时，我们可以选择自己创建镜像：
<code>Dockerfile</code>文件本质上是一个Docker能够理解的 txt文件。</p>
<p>每行命令都有两个部分组成：<code>&lt;INSTRUCTION&gt; &lt;argument&gt;</code>：</p>
<ul>
<li>我们习惯把命令（<code>INSTRUCTION</code>）全都大写：比如 <code>FROM</code>或<code>RUN</code></li>
<li><code>&lt;argument&gt;</code>小写。</li>
</ul>
<p>每一行命令的运行结果都是一个层（<code>layer</code>），每一层的都以上一层的结果为基础，执行命令。假设中途第N层出错，重新创建该镜像时，我们可直接使用N-1层的结果。
<div class="highlight"><pre><span></span><code><span class="k">FROM</span><span class="w"> </span><span class="s">ubuntu</span><span class="w">             </span><span class="c"># 以某个镜像为基础（常见的是“操作系统”镜像）</span>

<span class="k">RUN</span><span class="w"> </span>app-get<span class="w"> </span>update<span class="w">      </span>#<span class="w"> </span>安装依赖包
<span class="k">RUN</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>python

<span class="k">RUN</span><span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>flask
<span class="k">RUN</span><span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>flask-mysql

<span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>/opt/source-code<span class="w"> </span>#<span class="w"> </span>复制代码到镜像中

<span class="k">ENTRYPOINT</span><span class="w"> </span><span class="nv">FLASP_APP</span><span class="o">=</span>/opt/source-code/app.py<span class="w"> </span>flask<span class="w"> </span>run<span class="w">  </span>#<span class="w"> </span>镜像入口/程序启动命令
</code></pre></div></p>
<!-- TODO:加上其他命令：ENV， USER，CMD等 -->

<p>在<code>Dockerfile</code>所在的文件夹中，用该<code>Dockerfile</code>创建镜像：（<code>-t</code>==<code>--tag</code>给镜像加标签）
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>test/my-custom-image<span class="w"> </span>.
</code></pre></div>
将创建的镜像放Docker镜像库中：</p>
<p><div class="highlight"><pre><span></span><code>docker<span class="w"> </span>push<span class="w"> </span>test/my-custom-image
</code></pre></div>
⚠️ 基于镜像库可定制的特性，我们可以说“万物皆可镜像化”</p>
<p>运行图像 webapp-color 的实例，并将容器上的端口 8080 发布到主机上的 8282：
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>webapp-color<span class="w"> </span>-p<span class="w"> </span><span class="m">8282</span>:8080
</code></pre></div></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>-p &lt;Host-Port&gt;:&lt;Container-Port&gt;</code>其中，Host（主机）是 Docker 所在的操作系统，即可通过 ssh 进入的系统。 Container-Port 是容器的端口。 </p>
</div>
<p>检查某个镜像基于的操作系统，可以使用该镜像跑一个容器：
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>&lt;ImageName&gt;<span class="w"> </span>/bin/bash

<span class="c1"># 进入容器命令行工具之后：</span>
cat<span class="w"> </span>/etc/*-release

<span class="c1"># 退出容器</span>
<span class="nb">exit</span>
</code></pre></div>
结果如下：</p>
<p><img src="../ckad-8/cat_etc.png" width=400></p>
<div class="admonition note">
<p class="admonition-title">--rm</p>
<p>退出容器之后自动将该容器删除</p>
</div>
<p>查看当前环境下，镜像python的所有版本
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>images<span class="w"> </span>python
</code></pre></div></p>
<p><img src="../ckad-8/image-version.png" width=500></p>
<h3 id="k8s">k8s 安全性<a class="headerlink" href="#k8s" title="Permanent link">&para;</a></h3>
<p>我们知道k8s的集群上有两种Node： Master Node何Worker Node，其中Master Node是一个<code>kube-apiserver</code>服务器。通过对该服务器的访问，我们可以做任何事。那么要如何管理<code>kube-apiserver</code>服务器的 <strong>访问权限</strong> 呢：</p>
<ol>
<li>Authentication：谁可以访问<code>kube-apiserver</code>服务器？</li>
<li>Authorization：访问者可以做什么？</li>
</ol>
<h4 id="1-authentication">1. Authentication<a class="headerlink" href="#1-authentication" title="Permanent link">&para;</a></h4>
<p>谁可以访问集群？想访问集群的有这几种用户：</p>
<table>
    <tr>
        <th>用户</th>
        <th>功能</th>
        <th>用户类型</th>
        <th>帐号类型</th>
        <th>帐号由谁管理</th>
    </tr>
    <tr>
        <td>管理者 / Admin</td>
        <td>管理集群资源</td>
        <td>人类</td>
        <td>用户帐号 / `User`</td>
        <td>帐号由外部资源管理，比如证书，第三方身份认证（LDAP）</td>
    </tr>
    <tr>
        <td>开发者 / Developers</td>
        <td>做Deployment，将App建立起来等</td>
        <td>人类</td>
        <td>用户帐号 / `User`</td>
        <td>帐号由外部资源管理，比如证书，第三方身份认证（LDAP）</td>
    </tr>
    <tr>
        <td>机器人 / Bots</td>
        <td>即用于integration的第三方应用</td>
        <td>机器人<br/>（第三方进程或服务）</td>
        <td>服务帐号 / `ServiceAcount`</td>
        <td>帐号的管理比较简单，由`Kubernetes`自己管理。<br/><br/>  比如: <br/> - `k create sa my-sa`新建一个`ServiceAcount` <br/> - `k get sa`获取当前集群上所有的`ServiceAcount`</td>
    </tr>
    <tr>
        <td>终端用户 / End users</td>
        <td>由App自己管理，比如百度云要用户登陆之后才能访问，<br />不在kubernetes的管辖范围中，因此不做讨论</td>
        <td>-</td>
        <td>-</td>
        <td>-</td>
    </tr>
</table>

<h5 id="user">用户帐号 / <code>User</code><a class="headerlink" href="#user" title="Permanent link">&para;</a></h5>
<p>上面提到的四种用户中的<code>Admin</code>和<code>Developer</code>都属于“用户帐号”类型。而所有的用户都通过<code>kube-apiserver</code>来访问集群，有两种访问方式：</p>
<ol>
<li>通过<code>kubectl</code>工具</li>
<li>通过API：<code>curl https://kube-server-ip:6443</code></li>
</ol>
<p>两种类型的请求都汇集到<code>kube-apiserver</code>服务器。该服务器在处理请求之前对其进行身份验证（Authentication）。我们可以使用不同的 <strong>认证机制 / Authentication mechanism</strong> 来获得访问权限，比如：</p>
<ol>
<li>用户名 + 密码（Static Password File）</li>
<li>用户名 + Token（Static Token File）</li>
<li>证书（Certificates）</li>
<li>第三方认证服务（Identity Services）：如<code>LDAP</code>或者<code>Kerberos</code></li>
</ol>
<h6 id="1">认证机制 1：用户名 + 密码<a class="headerlink" href="#1" title="Permanent link">&para;</a></h6>
<p>1.创建<code>user-details.csv</code>：包含<code>password</code>，<code>username</code>，<code>userid</code>，<code>group</code>（可选），如下：</p>
<p><div class="highlight"><pre><span></span><code>password123, user1, u0001, group1
password123, user2, u0002, group1
password123, user3, u0003, group2
</code></pre></div>
2.然后将文件位置添加到<code>kube-apiserver</code>服务器的Pod的<code>.spec.containers.command</code>中的<code>--basic-auth-file</code>去，记得确保 <strong>重启</strong> <code>kube-apiserver</code>服务器</p>
<p><div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kube-apiserver</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kube-system</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">command</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kube-apiserver</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--authorization-mode=Node,RBAC</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--basic-auth-file=user-details.csv</span><span class="w">    </span><span class="c1"># 添加用于basic-auth的csv文件</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">k8s.gcr.io/kube-apiserver-amd64:v1.11.3</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kube-apiserver</span>
<span class="w">    </span><span class="nt">volumeMounts</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/tmp/users</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">usr-details</span>
<span class="w">      </span><span class="nt">readOnly</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hostPath</span><span class="p">:</span>
<span class="w">      </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/tmp/users</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DirectoryOrCreate</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">usr-details</span>
</code></pre></div>
⚠️ 查看该pod中<code>authorization</code>的内容有几种不同的方法：</p>
<ul>
<li><code>k describe pod kube-apiserver --namespace kube-system</code></li>
<li><code>cat /etc/kubernetes/manifests/kube-apiserver.yaml</code></li>
<li><code>ps aux | grep authorization</code></li>
</ul>
<p>3.创建相应的<code>Role</code>和<code>RoleBinding</code>，如下：</p>
<div class="highlight"><pre><span></span><code><span class="nn">---</span>
<span class="c1"># 创建Role</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Role</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io/v1</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pod-reader</span>
<span class="nt">rules</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">apiGroups</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;&quot;</span><span class="p p-Indicator">]</span><span class="w">     </span><span class="c1"># 注意 &quot;&quot; indicates the core API group，也可以是&quot;apps&quot;</span>
<span class="w">  </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;pods&quot;</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">verbs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;get&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;watch&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;list&quot;</span><span class="p p-Indicator">]</span>

<span class="nn">---</span>
<span class="c1"># 创建RoleBinding：允许user1访问&quot;default&quot;的namespace中所有的Pod</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RoleBinding</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io/v1</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">read-pods</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="nt">subjects</span><span class="p">:</span><span class="w">           </span><span class="c1"># subjects：实现了 RoleBinding 和 User 之间的绑定</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">User</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">user1</span>
<span class="w">  </span><span class="nt">apiGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io</span>
<span class="nt">roleRef</span><span class="p">:</span><span class="w">            </span><span class="c1"># roleRef（也叫Account）：实现了 RoleBinding 和 Role 之间的绑定</span>
<span class="w">  </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Role</span><span class="w">                 </span><span class="c1"># 也可以是ClusterRole</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pod-reader</span>
<span class="w">  </span><span class="nt">apiGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io</span>
</code></pre></div>
<p>⚠️ User名字区分大小写！</p>
<p>4.然后我们就通过 用户+密码 对集群进行访问了，比如通过API请求：</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-v<span class="w"> </span>-k<span class="w"> </span>https://master-node-ip:6443/api/vi/pods<span class="w"> </span>-u<span class="w"> </span><span class="s2">&quot;user1:password123&quot;</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note<p>-v: verbose，输出所有警告或错误信息 <br />
-k: 省略curl的安全检测步骤</p>
</p>
</div>
<h6 id="2-token">认证机制 2：用户名 + Token<a class="headerlink" href="#2-token" title="Permanent link">&para;</a></h6>
<ol>
<li>与 <strong>认证机制1</strong> 中类似，创建<code>user-token-details.csv</code>文件，举例：
<div class="highlight"><pre><span></span><code>KfhuSDbdFafJrenu732hb42, user1, u0001, group1
skjdhfue2kUKfhuSDbds7sjh, user2, u0002, group1
TmjfIG6aHW34jndjushdDUI, user3, u0003, group2
</code></pre></div></li>
<li>配置<code>kube-apiserver</code>服务器的Pod：用<code>--token-auth-file</code>而不是<code>--basic-auth-file</code></li>
<li>添加相应的<code>Role</code>和<code>RoleBinding</code></li>
<li>最后可用<code>curl</code>访问：
<div class="highlight"><pre><span></span><code>curl -v -k https://master-node-ip:6443/api/vi/pods -u &quot;Bearer KfhuSDbdFafJrenu732hb42&quot;
</code></pre></div></li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning<ul>
<li>不建议在生产环境中这样做。认证机制1和2仅用于学习和理解。 <br/></li>
<li>认证机制1和2已在Kubernetes 1.19版本中已被废弃，在以后的版本中也不再适用！</li>
</ul>
</p>
</div>
<h6 id="3-certificates">认证机制 3：证书 / Certificates<a class="headerlink" href="#3-certificates" title="Permanent link">&para;</a></h6>
<p><strong>证书 / Certificates</strong>的生成不在CKAD，而是在CKA的考试范围中，因此省略。这里假设证书已生成。可以通过<code>API</code>或者<code>k</code>工具进行使用：
<div class="highlight"><pre><span></span><code><span class="c1"># 用`API`：</span>
curl<span class="w"> </span>https://my-kube-playground:6443/api/v1/pods<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--key<span class="w"> </span>admin.key
<span class="w">    </span>--cert<span class="w"> </span>admin.crt
<span class="w">    </span>--cacert<span class="w"> </span>ca.crt
</code></pre></div></p>
<div class="admonition note">
<p class="admonition-title">Note<ul>
<li><code>--key</code>: (TLS) your private key for SSH</li>
<li><code>--cert</code>: (TLS) specified client certificate file</li>
<li><code>--cacert</code>: (TLS) to use the specified certificate file to verify the peer. CA = certificate authority</li>
</ul>
</p>
</div>
<div class="highlight"><pre><span></span><code><span class="c1"># 用`kubectl`工具：</span>
kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--server<span class="w"> </span>my-kube-playground:6443<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--client-key<span class="w"> </span>admin.key<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--client-certificate<span class="w"> </span>admin.crt
<span class="w">    </span>--certificate-authority<span class="w"> </span>ca.crt
</code></pre></div>
<p>我们可以简化<code>kubectl</code>的使用，因为每次输入这么长的命令有点麻烦。这时候就要用到<code>KubeConfig</code>文件了，我们可以生成一个<code>KubeConfig</code>文件，然后再用<code>kubectl</code>+<code>KubeConfig</code>访问Pod：
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>--kubeconfig<span class="w"> </span>config
</code></pre></div>
默认情况下，系统会去找这个路径下的<code>KubeConfig</code>文件：<code>$HOME/.kube/config</code>，如果我们也把我们的<code>KubeConfig</code>文件放在了这个默认路径中，那么我们只需要跑 <code>k get pods</code>即可！</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>$HOME</code>是一个变量，其值可以通过<code>echo $HOME</code>查看</p>
</div>
<p>那么<code>KubeConfig</code>文件长啥样呢？它由三个 <strong>列表</strong> 组成：</p>
<ul>
<li><code>Users</code></li>
<li><code>Clusters</code></li>
<li><code>Contexts</code></li>
</ul>
<p>他们之间的关系是<code>Clusters x Users = Contexts</code>如图：</p>
<p><img src="../ckad-8/kubeconfig.png" width=800></p>
<p>举例：</p>
<div class="highlight"><pre><span></span><code><span class="c1"># 举例：每个列表（`Users`，`Clusters`和`Contexts`）中包含一个item</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Config</span>

<span class="nt">current-context</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-kube-admin@my-kube-playground</span><span class="w">   </span><span class="c1"># 当前使用的context，可通过kubectl修改</span>

<span class="nt">clusters</span><span class="p">:</span><span class="w">                                           </span><span class="c1"># clusters列表</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-kube-playground</span>
<span class="w">  </span><span class="nt">cluster</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="nt">certificate-authority</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">etc/kubernetes/pki/ca.crt</span>
<span class="w">    </span><span class="nt">server</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://my-kube-playground:6443</span>

<span class="nt">contexts</span><span class="p">:</span><span class="w">                                           </span><span class="c1"># contexts列表</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-kube-admin@my-kube-playground</span>
<span class="w">  </span><span class="nt">context</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cluster</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-kube-playground</span>
<span class="w">    </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-kube-admin</span>
<span class="w">    </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span><span class="w">  </span><span class="c1"># 可选</span>

<span class="nt">users</span><span class="p">:</span><span class="w">                                              </span><span class="c1"># users列表</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-kube-admin</span>
<span class="w">  </span><span class="nt">user</span><span class="p">:</span>
<span class="w">    </span><span class="nt">client-certificate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">etc/kubernetes/pki/admin.crt</span>
<span class="w">    </span><span class="nt">client-key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">etc/kubernetes/pki/admin.key</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning<ul>
<li>该文件没有生成任何额外的k8s资源，只是负责把已有的资源利用和链接起来了 <br/></li>
<li>该文件 <strong>写完+保存</strong> 即可，<strong>不需要</strong> <code>k create -f .....yaml</code>来生成！！</li>
</ul>
</p>
</div>
<p>查看正在使用的<code>KubeConfig</code>文件：
<div class="highlight"><pre><span></span><code><span class="c1"># 查看默认文件路径下的KubeConfig，或者直接查看文件： $HOME/.kube/config</span>
kubectl<span class="w"> </span>config<span class="w"> </span>view

<span class="c1"># 查看某个特定的KubeConfig</span>
kubectl<span class="w"> </span>config<span class="w"> </span>view<span class="w"> </span>--kubeconfig<span class="o">=</span>my-customized-config<span class="w">   </span>
</code></pre></div></p>
<p>用自定义的<code>KubeConfig</code>文件代替默认的：
<div class="highlight"><pre><span></span><code><span class="c1"># 直接用customized的`KubeConfig`文件内容 取代默认的路径下的：</span>
mv<span class="w"> </span>/directory/to/my/config<span class="w"> </span><span class="nv">$HOME</span>/.kube/config
</code></pre></div></p>
<p>修改当前正在使用的<code>Context</code>，该命令会自动更新<code>KubeConfig</code>文件中的<code>.current-context</code>
<div class="highlight"><pre><span></span><code><span class="c1"># 使用默认路径下的KubeConfig文件</span>
kubectl<span class="w"> </span>config<span class="w"> </span>use-context<span class="w"> </span>&lt;Context-Name&gt;<span class="w">   </span>

<span class="c1"># 使用自定义的KubeConfig文件</span>
kubectl<span class="w"> </span>config<span class="w"> </span>use-context<span class="w"> </span>&lt;Context-Name&gt;<span class="w"> </span>--kubeconfig<span class="o">=</span>&lt;New-KubeConfig-File&gt;<span class="w">   </span>
</code></pre></div></p>
<div class="admonition note">
<p class="admonition-title">Config的YAML文件<ul>
<li><code>.clusters.cluster.certificate-authority: 文件路径</code> <br /></li>
<li><code>.clusters.cluster.certificate-authority-data: 加密后的文件内容</code></li>
</ul>
<p>两者能达到一样的目的！比如我们先对<code>ca.crt</code>文件进行加密：<code>cat ca.crt | base64</code> ，再把加密后的内容加到 <code>.clusters.cluster.certificate-authority-data:</code>里去</p>
</p>
</div>
<h4 id="2-authorization">2. Authorization：访问者可以做什么？<a class="headerlink" href="#2-authorization" title="Permanent link">&para;</a></h4>
<p>访问者可以做什么由 <strong>授权机制 / Authorization mechanism</strong> 决定。比如给管理者/Admin和开发者/Developer的权限肯定是不一样的。常见的 <strong>授权机制</strong> 有：</p>
<ol>
<li>Node Authorizor</li>
<li>ABAC授权（Attributed-based access control）</li>
<li>RBAC授权（Role-based access control）： 关联 <strong>用户</strong> 与 <strong>权限组</strong> </li>
<li>Webhook Mode<ul>
<li><code>AlwaysAllow</code></li>
<li><code>AlwaysDeny</code></li>
</ul>
</li>
</ol>
<p>使用哪一种授权机制由<code>kube-apiserver</code>的Pod文件上配置<code>--authorization-mode=</code>决定。多种机制可同时使用，只需用逗号隔开即可。多个机制之间是”或“的关系，只要有一个机制认可即可，用户请求会被所有授权机制按 <strong>从左到右的顺序</strong> 检查。比如：
<div class="highlight"><pre><span></span><code><span class="c1"># 外部用户访问时：</span>
<span class="c1">#   先由检查Node检查，被拒绝，</span>
<span class="c1">#   用RBAC检查通过了！用户的请求被redirect到`kube-apiserver`</span>
<span class="c1">#   Webhook不需要再检查</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">--authorization-mode=Node,RBAC,Webhook</span>
</code></pre></div></p>
<h5 id="1node-authorizor">授权机制 1：Node Authorizor<a class="headerlink" href="#1node-authorizor" title="Permanent link">&para;</a></h5>
<p><strong>集群内</strong> 的其他Node（带有<code>kubelet</code>）访问<code>kube-apiserver</code>服务器时，也需要Authorization - <strong>Node Authorizor</strong>。 <code>kubelet</code>作为系统节点组的一部分，有一个以系统节点为前缀的名字：<code>system.node.node01</code></p>
<h5 id="2abac">授权机制 2：ABAC<a class="headerlink" href="#2abac" title="Permanent link">&para;</a></h5>
<p>比如<code>dev</code>用户需要查看、创建和删除pod的权限。我们通过一个<code>Policy</code>文件来做到这一点，并将文件传输给<code>kube-apiserver</code>服务器。<strong>ABAC</strong>管理困难，因为需要手动修改<code>Policy</code>文件，并且每修改一次就要重启一次<code>kube-apiserver</code>服务器。</p>
<h5 id="3rbac">授权机制 3：RBAC<a class="headerlink" href="#3rbac" title="Permanent link">&para;</a></h5>
<p><img src="../ckad-8/rolebinding.png" width=500></p>
<p>通过创建不同的<code>Role</code>（比如Developer，Admin能做的事情不一样），并将<code>User</code>关联到所需的<code>Role</code>上</p>
<ol>
<li>
<p>新建<code>Role</code>： <code>.rules.verbs</code>表示该apiGroup可以执行的动作 
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Role</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span><span class="w">    </span><span class="c1"># 可选</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">developer</span>
<span class="nt">rules</span><span class="p">:</span>

<span class="w">  </span><span class="c1"># rule nr.1:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">apiGroups</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;&quot;</span><span class="p p-Indicator">]</span><span class="w">           </span><span class="c1"># &quot;&quot; indicates the core API group</span>
<span class="w">  </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;pods&quot;</span><span class="p p-Indicator">]</span><span class="w">   </span><span class="c1"># 针对pod资源</span>
<span class="w">  </span><span class="nt">verbs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;list&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;get&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;create&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;update&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;delete&quot;</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">resourceNames</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;blue&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p p-Indicator">]</span><span class="w">    </span><span class="c1"># 可选，用pod的名称进行筛选</span>

<span class="w">  </span><span class="c1"># rule nr.2:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">apiGroups</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;&quot;</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;ConfigMap&quot;</span><span class="p p-Indicator">]</span><span class="w">  </span><span class="c1"># 针对ConfigMap资源</span>
<span class="w">  </span><span class="nt">verbs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;create&quot;</span><span class="p p-Indicator">]</span>
</code></pre></div></p>
</li>
<li>
<p>用<code>RoleBinding</code> 将<code>User</code>关联到<code>Role</code>上
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RoleBinding</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span><span class="w">    </span><span class="c1"># 可选</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">devuser-developer-binding</span>
<span class="nt">subjects</span><span class="p">:</span><span class="w">   </span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">User</span><span class="w">                    </span><span class="c1"># 或者 kind: Group</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dev-user</span><span class="w">            </span><span class="c1"># &quot;name&quot;区分大小写</span>
<span class="w">  </span><span class="nt">apiGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io</span>
<span class="nt">roleRef</span><span class="p">:</span><span class="w">                            </span><span class="c1"># 指定与之绑定的Role</span>
<span class="w">  </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Role</span><span class="w">                    </span><span class="c1"># 或者ClusterRole</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">developer</span>
<span class="w">  </span><span class="nt">apiGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io</span>
</code></pre></div></p>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note<p><code>Role</code>和<code>Rolebinding</code>都可以被限制在某个<code>namespace</code>上，我们可以在yaml中的<code>.metadata.namespace</code>中写明</p>
</p>
</div>
<p><strong>关于<code>Role</code>和<code>RoleBinding</code>的一些命令</strong>
<div class="highlight"><pre><span></span><code><span class="c1"># 新建role</span>
kubectl<span class="w"> </span>create<span class="w"> </span>role<span class="w"> </span><span class="o">[</span>roleName<span class="o">]</span><span class="w"> </span>--verb<span class="o">=[</span>actionA<span class="o">]</span>,<span class="o">[</span>actionB<span class="o">]</span><span class="w"> </span>--resource<span class="o">=</span>pods
<span class="c1"># 查看所有的`Role` (用--namespace xxx或 --all-namespace（-A）来限定)</span>
kubectl<span class="w"> </span>get<span class="w"> </span>roles
<span class="c1"># 查看某个`Role`的权限</span>
kubectl<span class="w"> </span>describe<span class="w"> </span>role<span class="w"> </span>developer

<span class="c1"># 新建rolebinding</span>
kubectl<span class="w"> </span>create<span class="w"> </span>rolebinding<span class="w"> </span>NAME<span class="w"> </span>--clusterrole<span class="o">=</span>NAME<span class="p">|</span>--role<span class="o">=</span>NAME<span class="w"> </span><span class="o">[</span>--user<span class="o">=</span>username<span class="o">]</span><span class="w"> </span><span class="o">[</span>--group<span class="o">=</span>
<span class="c1"># 查看所有的`RoleBinding`</span>
kubectl<span class="w"> </span>get<span class="w"> </span>rolebindings
<span class="c1"># 查看某个`RoleBinding`的内容</span>
kubectl<span class="w"> </span>describe<span class="w"> </span>rolebinding<span class="w"> </span>devuser-role-binding
</code></pre></div>
<strong>查看权限</strong>
<div class="highlight"><pre><span></span><code><span class="c1"># 查看 当前用户（我） 是否有某个权限：</span>
kubectl<span class="w"> </span>auth<span class="w"> </span>can-i<span class="w"> </span>create<span class="w"> </span>deployments<span class="w"> </span>
kubectl<span class="w"> </span>auth<span class="w"> </span>can-i<span class="w"> </span>delete<span class="w"> </span>nodes
<span class="c1"># 查看名为 dev-user 的用户是否有某个权限：（在某个namespace中）</span>
kubectl<span class="w"> </span>auth<span class="w"> </span>can-i<span class="w"> </span>create<span class="w"> </span>deployments<span class="w"> </span>—-as<span class="w"> </span>dev-user
kubectl<span class="w"> </span>auth<span class="w"> </span>can-i<span class="w"> </span>delete<span class="w"> </span>nodes<span class="w"> </span>—-as<span class="w"> </span>dev-user<span class="w"> </span>—-namespace<span class="w"> </span><span class="nb">test</span>
</code></pre></div></p>
<div class="admonition note">
<p class="admonition-title">Role vs ClusterRole<p>Kubernetes中有<code>Role</code>和<code>ClusterRole</code>，<code>ClusterRole</code>是跨Namespace的存在，<code>ClusterRole</code>和<code>ClusterRoleBinding</code>的创建方法与<code>Role</code>类似。使用<code>Role</code>还是<code>ClusterRole</code>由使用场景决定</p>
</p>
</div>
<h5 id="4webhook">授权机制 4：Webhook<a class="headerlink" href="#4webhook" title="Permanent link">&para;</a></h5>
<p>从集群外部对Authorization进行管理，比如Open Policy Agent，会在收到请求后判断发送请求的用户是否有执行该动作的权利，如果有，才会redirect该请求到<code>kube-apiserver</code>服务器上</p>
<h4 id="3">3. 集群内部的交流<a class="headerlink" href="#3" title="Permanent link">&para;</a></h4>
<p>集群内部的组件（比如etcd，kube controller， manager scheduler和API server）与<code>kube-apiserver</code>服务器之间的交流都是由 <strong>TLS</strong> 加密过的。同一个集群上的不同Pod（上面的app）默认可以互相访问。如果有需要，我们可以通过 <code>NetworkPolicy</code> 来限制访问权限。</p>
<h4 id="4-admission-controller">4. Admission Controller<a class="headerlink" href="#4-admission-controller" title="Permanent link">&para;</a></h4>
<p>除了以上提到的<code>Authentication</code>和<code>Authorization</code>两个机制之外，kubernetes还提供了<code>Admission Controller</code>， 来控制一些<code>Authentication</code>和<code>Authorization</code>无法控制的东西，比如：</p>
<ul>
<li>只允许使用某个registry（即镜像数据库）中的镜像</li>
<li>不允许用户作为root跑Pod</li>
<li>规定Pod必须有labels</li>
</ul>
<p><img src="../ckad-8/admission_controller.png" width=700></p>
<p>查看当前启用的Admission Controller：进入容器 <code>kube-apiserver-controlplane</code>中并用<code>kube-apiserver</code>命令查看
<div class="highlight"><pre><span></span><code>k<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>kube-apiserver-controlplane<span class="w"> </span>-n<span class="w"> </span>kube-system<span class="w"> </span>--<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>kube-apiserver<span class="w"> </span>-h<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>enable-admission-plugins
</code></pre></div></p>
<!-- # 或者：ps -ef | grep kube-apiserver | grep admission-plugins -->

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code>kube-apiserver-controlplane</code> 是一个在 Namespace <code>kube-system</code>中的Pod，而进入该Pod中的容器之后，我们才可以使用 <code>kube-apiserver</code> 命令工具～</p>
</div>
<p>修改Admission Controller：
<div class="highlight"><pre><span></span><code>vi<span class="w"> </span>/etc/kubernetes/manifests/kube-apiserver.yaml<span class="w"> </span>

<span class="c1"># 在yaml的.spec.containers.command中:</span>

<span class="c1"># 1）添加</span>
-<span class="w"> </span>--enable-admission-plugins<span class="o">=</span>NamespaceAutoProvision

<span class="c1"># 2）删除</span>
-<span class="w"> </span>--disable-admission-plugins<span class="o">=</span>NamespaceAutoProvision
</code></pre></div></p>
<!--
修改 Admission Controller:
kubectl edit pod kube-apiserver --namespace kube-system

💡小贴士
根据[kube doc](https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/) 可以这修改：
添加：`kube-apiserver --enable-admission-plugins=NamespaceLifecycle,LimitRanger ...`
删除：`kube-apiserver --disable-admission-plugins=PodNodeSelector,AlwaysDeny ...`
-->

<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>NamespaceExists</code>和<code>NamespaceAutoProvision</code>已经被弃用，用<code>NamespaceLifecycle</code>代替：</p>
<ul>
<li>Namespace不存在时拒绝执行命令 <br /></li>
<li>确保默认的Namespace无法被删除： <code>default</code>, <code>kube-system</code> 和 <code>kube-public</code></li>
</ul>
</div>
<h5 id="k8sac">k8s提供的AC类型<a class="headerlink" href="#k8sac" title="Permanent link">&para;</a></h5>
<h6 id="1-validating-ac">1. Validating AC（验证类）<a class="headerlink" href="#1-validating-ac" title="Permanent link">&para;</a></h6>
<p>比如NamespaceExists 和 NamespaceAutoProvision，以下面命令为例：
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>run<span class="w"> </span>nginx<span class="w"> </span>--image<span class="w"> </span>nginx<span class="w"> </span>--namespace<span class="w"> </span>blue
</code></pre></div></p>
<ul>
<li>AC <code>NamespaceExists</code>默认为启用状态，并且会检查命令中提到的Namespace <code>blue</code>是否存在，如果不存在，该命令会报错。</li>
<li>AC <code>NamespaceAutoProvision</code>默认为关闭状态，若启用，则在Namespace <code>blue</code>不存在的情况下会自动生成一个</li>
</ul>
<h6 id="2-mutating-ac">2. Mutating AC（修改类）<a class="headerlink" href="#2-mutating-ac" title="Permanent link">&para;</a></h6>
<p>DefaultStorageClass 这个AC会观察 <strong>对存储类没有特定要求</strong> 的 <code>PersistentVolumeClaim</code> 的创建，并自动向它们添加默认存储类。
当我们查看创建的PVC时，我们可以看到该PVC的属性<code>StorageClass: default</code></p>
<div class="admonition warning">
<p class="admonition-title">AC执行顺序</p>
<p>k8s先使用<code>Mutating</code>再使用<code>Validating</code>的AC</p>
</div>
<h5 id="admission-controller">自定义Admission Controller<a class="headerlink" href="#admission-controller" title="Permanent link">&para;</a></h5>
<p>我们也可以自己定义Admission Controller，需要用到的工具有：</p>
<ul>
<li>Mutating Admission Webhook</li>
<li>Validating Admission Webhook</li>
</ul>
<p>通过下面两个步骤实现：</p>
<ol>
<li>建立服务器 <code>Admission Webhook Server</code>（以<code>Deployment</code>的形式）</li>
</ol>
<p><img src='../ckad-8/ac-webhook-deploy.png' width=600></p>
<ol>
<li>建立服务</li>
</ol>
<p><img src='../ckad-8/ac-webhook-svc.png' width=400></p>
<ol>
<li>用<code>ValidatingAdmissionConfiguration</code>或者<code>MutatingAdmissionConfiguration</code>进行配置。举例：</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">admissionregistration.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ValidatingWebhookConfiguration</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;pod-policy.example.com&quot;</span>
<span class="nt">webhooks</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;pod-policy.example.com&quot;</span>
<span class="w">      </span><span class="nt">clientConfig</span><span class="p">:</span><span class="w">   </span>
<span class="w">        </span><span class="nt">service</span><span class="p">:</span><span class="w">                             </span><span class="c1"># 服务器：通过服务访问</span>
<span class="w">          </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example-namespace&quot;</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example-service&quot;</span>
<span class="w">        </span><span class="nt">caBundle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;CA_BUNDLE&gt;</span><span class="w">                </span><span class="c1"># certificate bundle for TLS</span>
<span class="w">      </span><span class="nt">rules</span><span class="p">:</span><span class="w">                                 </span><span class="c1"># 规定什么时候使用自定义AC</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">apiGroups</span><span class="p">:</span><span class="w">   </span><span class="p p-Indicator">[</span><span class="s">&quot;&quot;</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">apiVersions</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;v1&quot;</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">operations</span><span class="p">:</span><span class="w">  </span><span class="p p-Indicator">[</span><span class="s">&quot;CREATE&quot;</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">resources</span><span class="p">:</span><span class="w">   </span><span class="p p-Indicator">[</span><span class="s">&quot;pods&quot;</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">scope</span><span class="p">:</span><span class="w">       </span><span class="s">&quot;Namespaced&quot;</span>
<span class="w">      </span><span class="nt">admissionReviewVersions</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;v1&quot;</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">sideEffects</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">None</span>
<span class="w">      </span><span class="nt">timeoutSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</code></pre></div>
<p>上面的例子中，Server也在同一个k8s cluster上，我们用一个service去访问该服务器。如果Server也在cluster外的话， clientConfig长这样：
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="nt">clientConfig</span><span class="p">:</span>
<span class="w">    </span><span class="nt">uri</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://my-server.com&quot;</span>
</code></pre></div></p>
<h3 id="namespaces">Namespaces<a class="headerlink" href="#namespaces" title="Permanent link">&para;</a></h3>
<p>kubernetes中有分Namespace和不分Namespace的资源：</p>
<table>
<thead>
<tr>
<th align="left">分Namespace</th>
<th align="left">不分Namespace</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">pods，replicasets，jobs，deployments，<br/> services，secrets，roles，rolebindings，<br/> configmaps，PVC</td>
<td align="left">nodes，PV，clusterroles，<br/> clusterrolebindings，certificatesigningrequests，<br/> namespaces</td>
</tr>
<tr>
<td align="left"><code>k api-resources --namespaced=true</code></td>
<td align="left"><code>k api-resources --namespaced=false</code></td>
</tr>
</tbody>
</table>
<p>可用<code>kubectl api-resources</code>结果中的NAMESPACED列查看，如下：</p>
<p><img src="../ckad-8/nsed.png" width=700></p>
<h3 id="api-groups">API Groups<a class="headerlink" href="#api-groups" title="Permanent link">&para;</a></h3>
<p>Kubernetes的 Endpoints 根据其目的不同，被分到不同的<strong>API组</strong>中。<strong>API组</strong>在两个地方用到：</p>
<ol>
<li>REST路径：<code>/apis/$GROUP_NAME/$VERSION</code></li>
<li>yaml文件中apiVersion的值：<code>apiVersion: $GROUP_NAME/$VERSIO</code>，比如<code>apiVersion: batch/v1</code></li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code>/api</code> 组做为最早，最核心的组，组名总是被省略，比如Pod的<code>apiVersion: v1</code>而不是<code>apiVersion: api/v1</code></p>
</div>
<p>常用的API组有：</p>
<ul>
<li><code>/api</code> 也叫core组，或者legacy组</li>
<li><code>/apis</code> 也叫named组</li>
<li><code>/metrics</code></li>
<li><code>/healthz</code></li>
<li><code>/version</code></li>
<li><code>/logs</code></li>
</ul>
<p>查看 API组及其版本：
<div class="highlight"><pre><span></span><code>k<span class="w"> </span>api-versions
</code></pre></div></p>
<p>其中与<strong>集群作用</strong>相关的是<strong>core组</strong>和<strong>named组</strong>，结构分别为：</p>
<table>
<thead>
<tr>
<th align="left"><strong>core组</strong> （<code>/api</code>）</th>
<th align="left"><strong>named组</strong>（<code>/apis</code>）</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><img src="api_core.webp" width="400" /></td>
<td align="left"><img src="api_apis.webp" width="800" /></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note<p>注意<code>/apis</code>结构更加整洁，<code>/api</code>组中的Endpoints也会在未来慢慢地被移动到<code>/apis</code>组中！
（图片来自<a href="https://www.waytoeasylearn.com/learn/api-groups-in-kubernetes/">这里</a>）</p>
</p>
</div>
<h4 id="api">API的使用<a class="headerlink" href="#api" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># 查看当前cluster中所有可用的API组：</span>
curl<span class="w"> </span>https://kube-master:6443<span class="w"> </span>-k

<span class="c1"># 查看某API组中所有可用的Resources</span>
curl<span class="w"> </span>https://kube-master:6443/apis<span class="w"> </span>-k
</code></pre></div>
<p>某些API是需要身份验证之后才能被使用。有两种方法：</p>
<p>1.使用<code>curl</code>的参数（比如<code>--key</code>）</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>https://kube-master:6443<span class="w"> </span>-k<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--key<span class="w"> </span>admin.key
<span class="w">    </span>--cert<span class="w"> </span>admin.crt
<span class="w">    </span>--cacert<span class="w"> </span>ca.crt
</code></pre></div>
<p>2.使用Kube Control Proxy程序查看 <strong>API组</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Kube控制代理命令启动了一个代理服务，并使用凭证和证书，端口为8001，效果等同于k proxy</span>
k<span class="w"> </span>proxy<span class="w"> </span><span class="m">8001</span><span class="p">&amp;</span>

<span class="c1"># proxy建立成功后，你会看到这条信息：Starting to serve on 127.0.0.1:8001</span>
<span class="c1"># 现在可以直接访问端口8001了，不需要certificates</span>
curl<span class="w"> </span>localhost:8001<span class="w"> </span>-k<span class="w"> </span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning<p><code>k proxy</code>和<code>kube proxy</code>是两个不同的东西！TODO</p>
</p>
</div>
<h4 id="api_1"><strong>API组</strong>的版本<a class="headerlink" href="#api_1" title="Permanent link">&para;</a></h4>
<p>有些API组有多个版本，比如<code>v1</code>，<code>v1alpha1</code>。我们可以通过proxy然后用REST访问查看
<div class="highlight"><pre><span></span><code>k<span class="w"> </span>proxy<span class="w"> </span><span class="m">8001</span><span class="p">&amp;</span>
curl<span class="w"> </span>https://localhost:8001/apis/&lt;API-Group&gt;

<span class="c1"># 比如，查看`batch`组的所有版本：</span>
curl<span class="w"> </span>https://kube-master:8001/apis/batch
</code></pre></div>
结果如下：其中<code>preferredVersion</code>（推荐版本）是默认使用的版本</p>
<p><img src="../ckad-8/version-of-api-group.png" width=300></p>
<p>或者用更简单的：</p>
<div class="highlight"><pre><span></span><code>k<span class="w"> </span>api-versions<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>batch
</code></pre></div>
<p>除了资源的<strong>推荐版本</strong>，也可能存在一个<strong>存储版本/storage version</strong>。是指最终存储到etcd数据库中的版本，假设该<strong>存储版本</strong>存在，则资源再存储时，都会先被转换成<strong>存储版本</strong>。</p>
<p><strong>存储版本</strong>没有办法通过<code>k</code>查看，我们可以直接查询etcd数据库，比如：
<div class="highlight"><pre><span></span><code><span class="nv">ETCDCTL_API</span><span class="o">=</span><span class="m">3</span><span class="w"> </span>etcdctl
<span class="w">    </span>--endpoints<span class="o">=</span>https://<span class="o">[</span><span class="m">127</span>.0.0.1<span class="o">]</span>:2379
<span class="w">    </span>--cacert<span class="o">=</span>/etc/kubernetes/pki/etcd/ca.crt
<span class="w">    </span>--cert<span class="o">=</span>/etc/kubernetes/pki/etcd/server.crt
<span class="w">    </span>--key<span class="o">=</span>/etc/kubernetes/pki
<span class="w">    </span>get<span class="w"> </span><span class="s2">&quot;/registry/deployments/default/blue&quot;</span><span class="w"> </span>--print-value-only
</code></pre></div></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>推荐版本</strong> 和 <strong>存储版本</strong> 都各自存有一个值，这个值可能是相同的，也有可能是不同的</p>
</div>
<h4 id="api_2">启用/禁用API版本<a class="headerlink" href="#api_2" title="Permanent link">&para;</a></h4>
<p>需要修改Pod <code>kube-apiserver-controlplane</code>的配置，最直接的方法是修改<code>/etc/kubernetes/manifest/api-server.yaml</code>文件：</p>
<div class="highlight"><pre><span></span><code><span class="c1"># 万一修改出错，cluster会崩坏，以防万一，先放一个备份</span>
<span class="l l-Scalar l-Scalar-Plain">cp /etc/kubernetes/manifests/kube-apiserver.yaml /root/kube-apiserver.yaml.backup</span>

<span class="l l-Scalar l-Scalar-Plain">vi /etc/kubernetes/manifests/kube-apiserver.yaml</span>

<span class="l l-Scalar l-Scalar-Plain"># 在spec.containers[0].command中</span>
<span class="l l-Scalar l-Scalar-Plain"># 添加版本：</span>
<span class="l l-Scalar l-Scalar-Plain">--runtime-config=batch/v2alpha1,v2,v2beta1</span>

<span class="l l-Scalar l-Scalar-Plain"># 删除某版本</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">--runtime-config=batch/v1=false</span>
</code></pre></div>
<p>接下来要等该Pod被重启，确定Pod处于运行状态，修改才真正被实现！</p>
<h4 id="api_3">API更新准则<a class="headerlink" href="#api_3" title="Permanent link">&para;</a></h4>
<p>1.API 元素只能通过增加 API 组的版本来删除 <br/>
<div class="highlight"><pre><span></span><code><span class="w">    </span>v1alpha1<span class="o">(</span>有<span class="s2">&quot;test&quot;</span>资源<span class="o">)=</span>&gt;<span class="w"> </span>v1alpha2<span class="o">(</span>无<span class="s2">&quot;test&quot;</span>资源<span class="o">)</span>
</code></pre></div>
2.API 对象必须能够在不同的 API 版本之间转换而不会丢失信息，（排除某版本中某资源不存在的情况）<br/>
<div class="highlight"><pre><span></span><code><span class="w">    </span>v1alpha1<span class="w"> </span>&lt;<span class="o">==</span>&gt;<span class="w"> </span>v1alpha2之间可以无缝转换
</code></pre></div></p>
<h4 id="api_4">API弃用准则<a class="headerlink" href="#api_4" title="Permanent link">&para;</a></h4>
<p>1.除了最新 API 版本之外，较旧的 API 版本在宣布弃用一段时间后必须得到支持。</p>
<ul>
<li>GA：不少于 12 个月或 3 次release</li>
<li>beta（测试版）：不少于 9 个月或 3 次release</li>
<li>alpha：0 release -&gt; 弃用之后不需要额外支持，所以当kubernetes版本升级，且不再包含某个资源的<code>v1alpha1</code>版本后，我们需要把该资源的版本都升级到<code>v1alpha2</code>
2.在发布新的 <strong>推荐版本</strong> 和 <strong>存储版本</strong> 之前，要至少存在过一个release，旧的和新的两个版本都被支持。换句话说，第一次发布的版本，不能成为 <strong>推荐版本</strong> 或 <strong>存储版本</strong> </li>
<li>在新的 API 版本发布之前，给定轨道中的 API 版本可能不会被弃用，至少发布稳定版本。</li>
</ul>
<h4 id="api_5">API版本发展<a class="headerlink" href="#api_5" title="Permanent link">&para;</a></h4>
<p>版本的发展历史大概是这样的：
    <code>v1alpha1</code> =&gt; <code>v1alpha2</code> =&gt; <code>v1beta1</code> =&gt; <code>v1</code>  GA版本（General Availability）</p>
<p>当产品达到 GA 时，它可以通过公司的一般销售渠道获得，而不是用于测试和用户反馈的 <em>有限版本</em> 或 <em>测试版</em>。</p>
<p>我们可以用以下命令更新资源使用的版本：
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>convert<span class="w"> </span>-f<span class="w"> </span>&lt;old-yaml-file&gt;<span class="w"> </span>--output-version<span class="w"> </span>&lt;new-api&gt;

<span class="c1"># 举例：把一个名为 nginx 的Deployment资源从版本 `apps/v1beta1` 更新到 `apps/v1`</span>
<span class="c1"># 该命令会输出一个新的yaml格式的定义</span>
kubectl<span class="w"> </span>convert<span class="w"> </span>-f<span class="w"> </span>nginx-old.yaml<span class="w"> </span>--output-version<span class="w"> </span>apps/v1<span class="w"> </span>&gt;<span class="w"> </span>nginx-new.yaml
</code></pre></div></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code>k convert</code>可能并不是默认可用的，它是一个额外的插件，需要自己安装，教程<a href="https://kubernetes.io/docs/tasks/tools/install-kubectl-linux/">在这里</a> <br />
1.下载binary文件<code>curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl-convert"</code> <br />
2.给binary文件可执行的权限：<code>chmod +x kubectl-convert</code> <br />
3.将binary文件移动到bin文件夹下<code>mv kubectl-convert /usr/local/bin</code> <br/>
4.现在可用使用：<code>k-convert --help</code></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Kubernetes API versions</strong> 是Kubernetes本身的版本，大概长这样：<code>1.22.2</code>，数字分别代表： <br />
- <code>1</code>: 主版本 / major version <br />
- <code>22</code>: 次要版本 / minor version <br />
- <code>2</code>: 补丁版本 / patch version <br /></p>
</div>
<h3 id="_2">自定义资源<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p>我们都知道新建一个Deployment会自动生成对应的Pod，这个过程由k8s自带的的Controller控制，拥有类似的Controller的还有ReplicaSet，Deployment，Job，Cronjob，Statefulset，Namespace。</p>
<p>如果我们想要自定义一个资源，那么我们可能要建立两样东西：</p>
<p><strong>1.Resource, 这里yaml文件要包含apiVersion，kind，metadata和spec，但kind值可以自定义。举例：</strong></p>
<p><div class="highlight"><pre><span></span><code><span class="c1"># flightticket.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flights.com/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FlightTicket</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-flight-ticket</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">from</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Mumbai</span>
<span class="w">  </span><span class="nt">to</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">London</span>
<span class="w">  </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
</code></pre></div>
<strong>2.CRD = Custom Resource Definition。kind值为 <code>CustomResourceDefinition</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># flightticket-custom-definition.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apiextensions.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CustomResourceDefinition</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flighttickets.flights.com</span><span class="w">   </span><span class="c1"># =spec.names.plural+&quot;.&quot;+spec.group</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">scope</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">namespaced</span><span class="w">     </span><span class="c1"># 可以是namespaced或者cluster</span>
<span class="w">  </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flights.com</span><span class="w">    </span><span class="c1"># API组，是Resource中apiVersion的值</span>
<span class="w">  </span><span class="nt">names</span><span class="p">:</span>
<span class="w">    </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FlightTicket</span><span class="w">  </span><span class="c1"># Resource 名，是Resource中kind的值</span>
<span class="w">    </span><span class="nt">singular</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flightticket</span>
<span class="w">    </span><span class="nt">plural</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flighttickets</span>
<span class="w">    </span><span class="nt">shortNames</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ft</span>
<span class="w">  </span><span class="nt">versions</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="w">      </span><span class="nt">served</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">      </span><span class="c1"># apiserver用的版本，so that it’s being served via REST API. preferred version？</span>
<span class="w">      </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">     </span><span class="c1"># storage version</span>
<span class="w">  </span><span class="nt">schema</span><span class="p">:</span><span class="w">               </span>
<span class="w">    </span><span class="nt">openAPIV3Schema</span><span class="p">:</span><span class="w">    </span><span class="c1"># shema定义了新建该Resource中spec的值</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<span class="w">      </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">        </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<span class="w">          </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">            </span><span class="nt">from</span><span class="p">:</span>
<span class="w">              </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">            </span><span class="nt">to</span><span class="p">:</span>
<span class="w">              </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">            </span><span class="nt">numer</span><span class="p">:</span>
<span class="w">              </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">integer</span>
<span class="w">              </span><span class="nt">minimum</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">              </span><span class="nt">maximum</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
</code></pre></div>
<p><strong>3.自定义控制器（Controller）</strong></p>
<p>Controller负责监视资源<code>FlightTicket</code>的状态，更新及删除，并在<code>FlightTicket</code>被创建的时候调用订飞机票的API（比如<code>https:book-flight.com/api</code>）。理论上Controller可以用任何编程语言书写，但Go有一个 Kubernetes Go Client，里面有写Controller所需的包，比如缓存和队列机制，模版<a href="https://github.com/kubernetes/sample-controller.git">在这里</a>。</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/kubernetes/sample-controller.git
<span class="nb">cd</span><span class="w"> </span>sample-controller

vi<span class="w"> </span>controller.go<span class="w">                </span><span class="c1"># 修改文件</span>

go<span class="w"> </span>build<span class="w"> </span>-o<span class="w"> </span>sample-controller<span class="w"> </span>.<span class="w"> </span><span class="c1"># 编译文件</span>

./sample-controller<span class="w"> </span>-kubeconfig<span class="o">=</span><span class="nv">$HOME</span>/.kube/config<span class="w"> </span><span class="c1"># 运行文件，将`$HOME/.kube/config`做为参数穿进去</span>
</code></pre></div>
<p><code>controller.go</code>源码大概长这样：</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">flightticket</span>

<span class="kd">var</span><span class="w"> </span><span class="nx">controllerKind</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">apps</span><span class="p">.</span><span class="nx">SchemeGroupVersion</span><span class="p">.</span><span class="nx">WithKind</span><span class="p">(</span><span class="s">&quot;FlightTicket&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">...</span>
<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">dc</span><span class="w"> </span><span class="o">*</span><span class="nx">FlightTicketController</span><span class="p">)</span><span class="w"> </span><span class="nx">callBookFlightAPI</span><span class="p">(</span><span class="w"> </span><span class="o">...</span>
</code></pre></div>
<p>我们一般把Controller打包到Docker镜像中，并在一个Pod中运行。</p>
<p><strong>4.用<code>kubectl create -f</code>创建 CRD文件 和 Resource文件</strong>
<div class="highlight"><pre><span></span><code>k<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>flightticket-custom-definition.yaml

k<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>flightticket.yaml
k<span class="w"> </span>get<span class="w"> </span>flightticket
</code></pre></div></p>
<h3 id="deployment-strategies">Deployment Strategies<a class="headerlink" href="#deployment-strategies" title="Permanent link">&para;</a></h3>
<p>我们之前讨论过两个Deployment Strategies，然而还有更多的Strategies：</p>
<ol>
<li><code>RollingUpdate</code>：（默认的Strategy）关一个旧的Pod，新建一个新的Pod，以保证用户用永远可以访问到</li>
<li><code>Recreate</code>：关闭所有旧Pod，然后在建立新Pod</li>
<li><code>Blue/Green</code>：旧Pod是Blue组，新Pod是Green组，先做测试，将用所有的traffic都导到Blue上去，当测试通过后，所有traffic都改到Green组上去。</li>
<li><code>Canary</code>：在该Strategies中，新旧Pod也同时存在，然而，大部分traffic还是访问旧Pod，只有一小部分traffic访问新Pod</li>
</ol>
<h4 id="bluegreen">Blue/Green<a class="headerlink" href="#bluegreen" title="Permanent link">&para;</a></h4>
<p>该Strategy其实可以通过Istio更轻松地实现，但我们这里先不使用Istio这个额外的工具。k8s自己可以实现Blue/Green，分成两步：</p>
<p>1.通过Service访问Blue组：
<div class="highlight"><pre><span></span><code><span class="nn">...</span><span class="w">             </span><span class="c1"># Service: svc.yaml</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nn">...</span>
<span class="nt">spec</span><span class="p">:</span><span class="w">           </span><span class="c1"># Deployment: blue.yaml</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp-pod</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nn">...</span>
<span class="nt">spec</span><span class="p">:</span><span class="w">           </span><span class="c1"># Deployment: green.yaml</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp-pod</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v2</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v2</span>
</code></pre></div>
2.修改Service标签，从而访问Green组：
<div class="highlight"><pre><span></span><code><span class="nn">...</span><span class="w">             </span><span class="c1"># Service: svc.yaml</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v2</span>
</code></pre></div></p>
<h4 id="canary">Canary<a class="headerlink" href="#canary" title="Permanent link">&para;</a></h4>
<p>在该Strategies中，新旧Pod也同时存在，然而，大部分traffic还是访问旧Pod，只有一小部分traffic访问新Pod，这个过程相当于在做测试。当测试通过之后，再把旧的Pod都取代掉（比如用RollingUpdate）。</p>
<p>实现方法：用同一个Service访问新旧两个Deployment（用一个两个Deployment中都存在的label即可），但是新旧两个Deployments中的Pod数量不同：</p>
<ul>
<li>旧Deployment有5个Pods</li>
<li>新Deployment只有1个Pod</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>通过减少Pod的数量减少traffic，是因为Service对每个Pod的访问都是随机的，并不是以Deployment为单位来进行traffic的分配！！</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>k8s中我们无法非常精确的控制traffic的百分比，但<code>Istio</code>可以，比如99%的traffic访问旧Pod，1%访问新Pod</p>
</div>
<h3 id="helm-chart">Helm Chart<a class="headerlink" href="#helm-chart" title="Permanent link">&para;</a></h3>
<p>k8s有太多Resource了，我们经常需要给每个Resource写一个Yaml文件，然后分别用<code>k create -f xxx.yaml</code>来创建这些Resource的对象。修改和删除更是需要手动完成，比如我要shopify网站就会非常复杂。</p>
<p>Helm解决了这个难题，我们可以把它当作Kubernetes的package manager，它把所有Resource的对象都打包了，现在我们只需要告诉Helm，我要使用package <code>shopify</code>即可：</p>
<p>Helm将普通yaml文件结构成 模版文件+变量文件。</p>
<h4 id="_3">常用命令：<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>version
helm<span class="w"> </span>list

<span class="c1"># 下载但是不安装</span>
helm<span class="w"> </span>pull<span class="w"> </span>shopify
helm<span class="w"> </span>pull<span class="w"> </span>--untar<span class="w"> </span>shopify<span class="w"> </span><span class="c1"># 解压</span>

<span class="c1"># 自定义/修改：</span>
ls<span class="w"> </span>shopify
helm<span class="w"> </span>install<span class="w"> </span>new-shopify<span class="w"> </span>./shopify

<span class="c1"># 下载Chart并使用</span>
helm<span class="w"> </span>install<span class="w"> </span>&lt;AppName&gt;<span class="w"> </span>&lt;RepoName&gt;/&lt;ChartName&gt;
helm<span class="w"> </span>install<span class="w"> </span>my-shop<span class="w"> </span>bitnami/shopify


<span class="c1"># 更新</span>
helm<span class="w"> </span>upgrade<span class="w"> </span>shopify

helm<span class="w"> </span>rollback<span class="w"> </span>shopify

helm<span class="w"> </span>uninstall<span class="w"> </span>my-shop

<span class="c1"># 在默认的Chart数据库（hub）中搜索：https://artifacthub.io/</span>
helm<span class="w"> </span>search<span class="w"> </span>hub<span class="w"> </span>shopify<span class="w">   </span>

<span class="c1"># 添加额外数据库</span>
helm<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>bitnami<span class="w"> </span>https://charts.bitnami.com/bitnami

<span class="c1"># 在额外的Chart数据库（repo）中搜索</span>
helm<span class="w"> </span>search<span class="w"> </span>repo<span class="w"> </span>shopify<span class="w">   </span>
<span class="c1"># 查看已添加的额外数据库</span>
helm<span class="w"> </span>repo<span class="w"> </span>list
</code></pre></div>
<h4 id="linux">在Linux上安装<a class="headerlink" href="#linux" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-fsSL<span class="w"> </span>-o<span class="w"> </span>get_helm.sh<span class="w"> </span>https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3
chmod<span class="w"> </span><span class="m">700</span><span class="w"> </span>get_helm.sh
./get_helm.sh
</code></pre></div>
<h3 id="_4">其他<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th align="left">命令</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>k get clusterrole --no-headers | wc -l</code></td>
<td align="left">数结果有几个（没有表头）</td>
</tr>
<tr>
<td align="left"><code>k api-resources</code></td>
<td align="left">查看资源的全称，缩写，api版本，是否namespaced，以及Kind的值</td>
</tr>
<tr>
<td align="left"><code>ls /etc/kubernetes/manifests</code></td>
<td align="left">输出结果：<br/> etcd.yaml  <br/> kube-apiserver.yaml  <br/> kube-controller-manager.yaml  <br/> kube-scheduler.yaml</td>
</tr>
<tr>
<td align="left"><code>cat /etc/os-release</code></td>
<td align="left">查看当前OS系统</td>
</tr>
</tbody>
</table>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.tabs.link", "navigation.prunes"], "search": "../../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.407015b8.min.js"></script>
      
    
  </body>
</html>