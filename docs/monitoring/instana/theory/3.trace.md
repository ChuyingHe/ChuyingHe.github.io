# 1. Automatic Tracing
- **Fully automatic**: Java, Scala, Python, PHP, .net/.net core*
- **Only requires Instana library inclusion**: NodeJS, Golang, Ruby, Crystal

100% Tracing: We don't sample! We record all!

Trace & Call & Span


<img src="../../imgs/tracing.png" width=800>


## Trace

A **Trace** is composed of one or more **calls**.


### Trace Timing

- **Total Time**: the total (clock) time of a call
- **Wait Time**: the amount of time the call spends waiting on all downstream calls to complete = Sum of all downstream calls **Total Time**
- **Self Time**: The difference between the ^^caller's Exit Span Time^^ and the ^^call's Entry Span Time^^
    ```
    Self Time = Total Time - Wait Time - Network Time
    ```

!!! info "Example"
    <img src="../../imgs/trace_timing_exp.png" width=600>

## Calls

A **Call** describes an activity within a monitored process, typically a request between two services. Every **Call** is comprised of one or more **Spans**


## Spans
Types of Spans:

- **Entry Span**: a request from an uninstrumented process to an instrumented process. 

    Entry Span è¡¨ç¤ºè¯·æ±‚è¿›å…¥ä¸‹ä¸€ä¸ªæœåŠ¡æˆ–ç»„ä»¶æ—¶çš„æ—¶é—´è·¨åº¦ã€‚It contains **Source Details**

    ğŸŒ° å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç”µå•†ç½‘ç«™ï¼Œå½“ç”¨æˆ·åœ¨å‰ç«¯é¡µé¢ç‚¹å‡»â€œä¸‹å•â€æŒ‰é’®æ—¶ï¼Œè¿™ä¸ªè¯·æ±‚è¢«å‘é€åˆ°åç«¯è®¢å•æœåŠ¡ã€‚æ­¤æ—¶ï¼Œè®¢å•æœåŠ¡ä¼šä¸ºè¿™ä¸ªè¯·æ±‚åˆ›å»ºä¸€ä¸ª Entry Spanã€‚è¿™ä¸ª Entry Span çš„èµ·ç‚¹æ˜¯è®¢å•è¯·æ±‚åˆ°è¾¾è®¢å•æœåŠ¡çš„æ—¶é—´ï¼Œç»ˆç‚¹æ˜¯è®¢å•æœåŠ¡å¼€å§‹å¤„ç†è¯¥è¯·æ±‚çš„æ—¶é—´ã€‚
    
- **Exit Span**: a call from an instrumented process to an uninstrumented process. 

    Exit Span è¡¨ç¤ºè¯·æ±‚ä»å½“å‰æœåŠ¡æˆ–ç»„ä»¶å‘é€å‡ºå»çš„æ—¶é—´è·¨åº¦ã€‚It contains **Destination Details**

    ğŸŒ° ç»§ç»­ä¸Šé¢çš„ä¾‹å­ï¼Œå½“è®¢å•æœåŠ¡å¤„ç†å®Œç”¨æˆ·çš„è®¢å•è¯·æ±‚åï¼Œéœ€è¦è°ƒç”¨æ”¯ä»˜æœåŠ¡æ¥å¤„ç†ä»˜æ¬¾ã€‚æ­¤æ—¶ï¼Œè®¢å•æœåŠ¡ä¼šåˆ›å»ºä¸€ä¸ª Exit Spanã€‚è¿™ä¸ª Exit Span çš„èµ·ç‚¹æ˜¯è®¢å•æœåŠ¡å¼€å§‹å‘æ”¯ä»˜æœåŠ¡å‘é€è¯·æ±‚çš„æ—¶é—´ï¼Œç»ˆç‚¹æ˜¯è¯·æ±‚è¢«æˆåŠŸå‘é€å‡ºå»å¹¶ç­‰å¾…æ”¯ä»˜æœåŠ¡å“åº”çš„æ—¶é—´ã€‚

- **Exit+Entry Span** - a request from an instrumented process to another instrumented process. There will be an exit span for the client process (caller) and an entry span for the process serving the response (callee). Example: An HTTP call that is called from another HTTP Call. 

    ğŸŒ° **Exit Span å’Œ Entry Span çš„ç»„åˆ**é€šå¸¸ç”¨äºæè¿°è¯·æ±‚åœ¨æœåŠ¡ä¹‹é—´ä¼ é€’æ—¶çš„å®Œæ•´è·¯å¾„ã€‚è¿™ç§ç»„åˆæœ‰åŠ©äºå…¨é¢äº†è§£è¯·æ±‚ä»ä¸€ä¸ªæœåŠ¡ä¼ é€’åˆ°å¦ä¸€ä¸ªæœåŠ¡çš„æ•´ä¸ªè¿‡ç¨‹ã€‚é€šè¿‡ç»“åˆ Exit Span å’Œ Entry Spanï¼Œå¯ä»¥è¿½è¸ªè¯·æ±‚åœ¨ç³»ç»Ÿä¸­çš„å®Œæ•´æµå‘ï¼Œå¹¶è¯†åˆ«å¯èƒ½çš„æ€§èƒ½ç“¶é¢ˆæˆ–å»¶è¿Ÿä½ç½®ã€‚



!!! note "(un)instrumented process"
    An **instrumented process** is one that has been set up with tools or mechanisms to collect data about its performance, status, and behavior.


!!! note "Trans/Spans"
    The concept of Traces and Spans comes from:

    - [Google "Dapper, a Large-Scale Distributed Systems Tracing Infrastructure](https://ai.google/research/pubs/pub36356)
    - [The OpenTracing Semantic Specification](https://github.com/opentracing/specification/blob/master/specification.md)

    They area also open source **Tracing Technologies** that Instana supports.

# Endpoints
**Endpoints** define the API of a service. Every endpoint has a single, automatically discovered type: `BATCH`, `Database`, `HTTP`, `MESSAGING`, `RPC`, `GraphQL`

<img src="../../imgs/endpoints.png" width=800>

# Service
A **service** is a bucket of endpoints that typically maps to Infrastructure.

- If multiple instances of this e.g. container operate at the same time, they will all map to the same logical service.
- Service `types`(HTTP, Database, Messaging) & `names` are assigned automatically through inheritance from endpoints.

<img src="../../imgs/service.png" width=600>

**Service** in the UI:

<img src="../../imgs/service-2.png" width=800>

Configure **Custom Service Rule**:

<img src="../../imgs/service-3.png" width=800>

!!! warning "Service"
    A bit like the `service` concept in OpenShift

!!! info "Latency"
    **Latency** is a measure of delay, usually in milliseconds.     
    
    **Endpoint Latency** indicates how quickly an endpoint responds to incoming requests.


## Service > Analyze Calls
The Service `catalogue-demo` dashboard:

<img src="../../imgs/service-4.png" width=800>

After you click **Analyze Calls**:

<img src="../../imgs/service-5.png" width=800>


# 2. Application Perspective (AP)
>  An **Application Perspective** represents a set of services and endpoints that are defined by a shared context and is declared by using **tags**.

The Applications can be filtered by the following ^^patterns^^:

- by Team: `Service=Cart|Payment|Checkout`
- by Environment: `Tag=Production`
- by Call Data:
    - HTTP Param: `WS_Name=Search`
    - HTTP header: `account_id=001`


!!! note "Example"
    <img src="../../imgs/app-1.png" width=700>

    Calls filtered after `service.name="Customer Care"`:

    <img src="../../imgs/app-2.png" width=700>

    Calls filtered after `service.name="Fleet Management"` & `http.parameters.tenant="Kiosk"`:

    <img src="../../imgs/app-3.png" width=700>

    Calls filtered after `service.name="Finance"`

    <img src="../../imgs/app-4.png" width=700>

Filter to get a new **Application Perspective**:

<img src="../../imgs/app-5.png" width=700>
<img src="../../imgs/app-6.png" width=700>

## Analyze Profile
You can also analyze the profile of the request

<img src="../../imgs/profile.png" width=700>

